
```{r}
library(tidyverse)

# GLOPNET
d <- read_csv("./data/nature02403-s2.csv", skip = 10)

d2 <- d %>%
  dplyr::select(Am = `log Amass`, Aa = `log Aarea`, LMA = `log LMA`,
  gs = `log Gs`, Pm = `log Pmass`, Nm = `log Nmass`) %>% as.data.frame

dim(d2)
d3 <- is.na(d2) %>% apply(., 2, sum) %>% as.data.frame
names(d3)  <- "val"
d3[, "trait"] <- rownames(d3)
d3[, "all"] <- dim(d2)[1]
d3 <- d3 %>%
  mutate(val2 = all - val)

ggplot(d3, aes(x = trait, y = val2/all* 100)) +
  geom_bar(stat = "identity", fill = "grey70") +
  #geom_text(data = tmp1, aes(label = Freq2, y = 50)) +
  ylab("Data coverage (%)") +
  xlab("") +
  theme_bw()

nb <- estim_ncpPCA(d2,ncp.min=0,ncp.max=4, maxiter = 2000) 
res <- imputePCA(d2, ncp=2, scale=T, method="Regularized")
res2 <- imputePCA(d2, ncp=1, scale=T, method="Regularized")

pca1 <- prcomp(res$completeObs)
pca2 <- prcomp(res2$completeObs)

table(d$GF)



```

you need to record 

- data import (how you loaded your data)
- data cleaning (how you modified your data)
- analysis (how you did PCA)
- visualization ( how you made your figs )

Otherwise, I can't say which part was the problem. Many journals now require to
submit code.

From the figure, I can't tell you did log-transform or not. Also I'm  not sure
how you handled the missing data. 
