setwd("~/Dropbox/MS/LES_MS/LMApsModel/data/")
# setwd("~/Dropbox/MS/LES_MS/LMApsModel/md/")
# render("GL_check.rmd", "bookdown::pdf_book")
# use null result 1
null_n <- 3
# GL data -------------------------------------------------------------------
load("GL_model1_obs_2017-06-19_.RData")
s1 <- fit.summary
GL <- data.obs
P_vec <- paste("p[", 1:nrow(GL), "]" ,sep = "")
GL <- GL %>%
mutate(DE = ifelse(GL$DE == "", "U", as.character(DE))) %>%
mutate(LMAp1 =  fit.summary[P_vec, "mean"] * LMA) %>%
mutate(LMAs1 = LMA - LMAp1)
load("GL_model1r4_obs_2017-06-19_.RData")
s4 <- fit.summary
GL <- GL %>%
mutate(LMAp4 =  fit.summary[P_vec, "mean"] * LMA) %>%
mutate(LMAs4 = LMA - LMAp4)
head(GL)
load("GL_model1_LMA_2017-06-19_.RData")
s1LMA <- fit.summary.list[[null_n]]
temp <- LMA.ra.data[,null_n]
GL <- GL %>%
mutate(LMA_ra = temp) %>%
mutate(LMAp1_ra =  s1LMA[P_vec, "mean"] * LMA_ra) %>%
mutate(LMAs1_ra = LMA_ra - LMAp1_ra)
head(GL)
load("GL_model1_All_2017-06-19_.RData")
# sp order
s1ALL <- fit.summary.list[[null_n]]
# sp order
temp <- LMA.ra2.data[[null_n]]
#arrange(LMA)
GL <- GL %>%
#arrange(LMA) %>%
mutate(LMA_all = temp[,"LMA"]) %>%
mutate(LMAp1_all =  s1ALL[P_vec, "mean"] * LMA_all) %>%
mutate(LMAs1_all = LMA_all - LMAp1_all) %>%
mutate(LL_all = temp[, "LL"]) %>%
mutate(Rarea_all = temp[, "Rarea"]) %>%
mutate(Aarea_all = temp[, "Aarea"])
load("GL_model1r4_All_2017-06-19_.RData")
s4ALL <- fit.summary.list[[null_n]]
temp <- LMA.ra2.data[[null_n]]
GL <- GL %>%
mutate(LMAp4_all =  s4ALL[P_vec, "mean"] * LMA_all) %>%
mutate(LMAs4_all = LMA_all - LMAp4_all)
load("GL_model1r4_LMA_2017-06-19_.RData")
s4LMA <- fit.summary.list[[null_n]]
GL <- GL %>%
mutate(LMAp4_ra =  s1LMA[P_vec, "mean"] * LMA_ra) %>%
mutate(LMAs4_ra = LMA_ra - LMAp4_ra)
head(GL)
lim_func <- function(trait){
mid_len <- (log10(max(trait, na.rm = T)) - log10(min(trait, na.rm = T))) /2
max_lim <- log10(max(trait, na.rm = T)) + mid_len * 0.3
min_lim <- log10(min(trait, na.rm = T)) - mid_len * 0.3
return(10^(c(min_lim, max_lim)))
}
GL.each <- function(x, y, x_text = NULL, y_text = NULL, subscript = NULL){
dec <- GL %>%
filter(DE == "D")
ev <- GL %>%
filter(DE == "E")
un <- GL %>%
filter(DE == "U")
LMA_rand <- paste(x, "_ra", sep = "")
options("scipen" = 100)
if(x == "LMA") plot(GL[ , x], GL[ ,y],
log = "xy", axes = F,
xlim = lim_func(GL[ , x]), ylim = lim_func(GL[ ,y]),
type = "n") else {
plot(GL[ , x], GL[ ,y],
log = "xy", axes = F,
xlim = lim_func(GL[ , x]), ylim = lim_func(GL[ ,y]),
type = "n")
}
mtext(subscript, side = 3, line = -1, adj = 0, cex = 0.65)
box()
if (x != "LMA") points(GL[ , LMA_rand], GL[ ,y], col = "gray", pch = 19, cex = 0.8)
points(un[ , x], un[ ,y], col = "black", pch = 21, bg = "white")
points(ev[ , x], ev[ ,y], col = "black", pch = 21, bg = "green4")
points(dec[ , x], dec[ ,y], col = "black", pch = 21, bg = "dark orange")
if(is.null(y_text) != TRUE){
axis(2, tick = FALSE,line = -0.8, cex.axis = 0.9)
axis(2, tcl = 0.2, labels = FALSE)
mtext(y_text, side = 2, line = 1.2, cex = 0.8)
}
if(is.null(x_text) != TRUE){
axis(1, tick = FALSE, line = -0.8, cex.axis = 0.9)
axis(1, tcl = 0.2, labels = FALSE, cex = 0.8)
mtext(x_text, side = 1, line = 1.5, cex = 0.8)
}
}
par(mfrow = c(3, 3))
par(mar = c(0, 0, 0, 0))
par(oma = c(3, 3, 2, 2))
GL.each(x = "LMA", y = "Aarea", subscript = " (a)",
y_text = expression(paste(italic(A)[area]," (", mu, "mol ", m^-2," ", s^-1, ")")))
par(xpd=NA)
legend(10, 80, c("Evergreen", "Deciduous", "Unclassfied", "Rand"),
pch = c(21, 24, 21, 21),
pt.bg = c("green4", "dark orange", "white", "gray"),
col = c("black", "black", "black", "gray"),
pt.lwd = c(0.8, 0.8, 0.8),
bty = "n",
# lwd=0.8,
cex = 0.9,
pt.cex = 1,
ncol = 4)
par(xpd=TRUE)
GL.each(x = "LMAp1", y = "Aarea", subscript = " (b)")
GL.each(x = "LMAs1", y = "Aarea", subscript = " (c)")
GL.each(x = "LMA", y = "Rarea", subscript = " (d)",
y_text = expression(paste(italic(R)[area]," (", mu, "mol ", m^-2," ", s^-1, ")")))
GL.each(x = "LMAp1", y = "Rarea", subscript = " (e)")
GL.each(x = "LMAs1", y = "Rarea", subscript = " (f)")
GL.each(x = "LMA", y = "LL", subscript = " (g)",
y_text = expression(paste("LL (months)")),
x_text = expression(paste("LMA (g ",m^-2,")")))
GL.each(x = "LMAp1", y = "LL", subscript = " (h)",
x_text = expression(paste("LMAp (g ",m^-2,")")))
GL.each(x = "LMAs1", y = "LL", subscript = " (i)",
x_text = expression(paste("LMAs (g ",m^-2,")")))
par(mfrow = c(3, 3))
par(mar = c(0, 0, 0, 0))
par(oma = c(3, 3, 2, 2))
GL.each(x = "LMA", y = "Aarea", subscript = " (a)",
y_text = expression(paste(italic(A)[area]," (", mu, "mol ", m^-2," ", s^-1, ")")))
par(xpd=NA)
legend(10, 80, c("Evergreen", "Deciduous", "Unclassfied", "Rand"),
pch = c(21, 24, 21, 21),
pt.bg = c("green4", "dark orange", "white", "gray"),
col = c("black", "black", "black", "gray"),
pt.lwd = c(0.8, 0.8, 0.8),
bty = "n",
# lwd=0.8,
cex = 0.9,
pt.cex = 1,
ncol = 4)
par(xpd=TRUE)
GL.each(x = "LMAp4", y = "Aarea", subscript = " (b)")
GL.each(x = "LMAs4", y = "Aarea", subscript = " (c)")
GL.each(x = "LMA", y = "Rarea", subscript = " (d)",
y_text = expression(paste(italic(R)[area]," (", mu, "mol ", m^-2," ", s^-1, ")")))
GL.each(x = "LMAp4", y = "Rarea", subscript = " (e)")
GL.each(x = "LMAs4", y = "Rarea", subscript = " (f)")
GL.each(x = "LMA", y = "LL", subscript = " (g)",
y_text = expression(paste("LL (months)")),
x_text = expression(paste("LMA (g ",m^-2,")")))
GL.each(x = "LMAp4", y = "LL", subscript = " (h)",
x_text = expression(paste("LMAp (g ",m^-2,")")))
GL.each(x = "LMAs4", y = "LL", subscript = " (i)",
x_text = expression(paste("LMAs (g ",m^-2,")")))
GL.each <- function(x, y, x_text = NULL, y_text = NULL, subscript = NULL){
dec <- GL %>%
filter(DE == "D")
ev <- GL %>%
filter(DE == "E")
un <- GL %>%
filter(DE == "U")
LMA_rand <- paste(x, "_all", sep = "")
y_rand <- paste(y, "_all", sep = "")
options("scipen" = 100)
if(x == "LMA") plot(GL[ , x], GL[ ,y],
log = "xy", axes = F,
xlim = lim_func(GL[ , x]), ylim = lim_func(GL[ ,y]),
type = "n") else {
plot(GL[ , x], GL[ ,y],
log = "xy", axes = F,
xlim = lim_func(GL[ , x]), ylim = lim_func(GL[ ,y]),
type = "n")
}
mtext(subscript, side = 3, line = -1, adj = 0, cex = 0.65)
box()
if (x != "LMA") points(GL[ , LMA_rand], GL[ ,y_rand], col = "gray", pch = 19, cex = 0.8)
# if (str_detect(x, "ra") == TRUE) points(GL[ , "LMA_ra"], GL[ ,y], col = "gray", pch = 19, cex = 0.8) else if (str_detect(x, "all") == TRUE) points(GL[ , "LMA_all"], GL[ ,y], col = "gray", pch = 19, cex = 0.8)
points(un[ , x], un[ ,y], col = "black", pch = 21, bg = "white")
points(ev[ , x], ev[ ,y], col = "black", pch = 21, bg = "green4")
points(dec[ , x], dec[ ,y], col = "black", pch = 21, bg = "dark orange")
if(is.null(y_text) != TRUE){
axis(2, tick = FALSE,line = -0.8, cex.axis = 0.9)
axis(2, tcl = 0.2, labels = FALSE)
mtext(y_text, side = 2, line = 1.2, cex = 0.8)
}
if(is.null(x_text) != TRUE){
axis(1, tick = FALSE, line = -0.8, cex.axis = 0.9)
axis(1, tcl = 0.2, labels = FALSE, cex = 0.8)
mtext(x_text, side = 1, line = 1.5, cex = 0.8)
}
}
par(mfrow = c(3, 3))
par(mar = c(0, 0, 0, 0))
par(oma = c(3, 3, 2, 2))
GL.each(x = "LMA", y = "Aarea", subscript = " (a)",
y_text = expression(paste(italic(A)[area]," (", mu, "mol ", m^-2," ", s^-1, ")")))
par(xpd=NA)
legend(10, 80, c("Evergreen", "Deciduous", "Unclassfied", "Rand"),
pch = c(21, 24, 21, 21),
pt.bg = c("green4", "dark orange", "white", "gray"),
col = c("black", "black", "black", "gray"),
pt.lwd = c(0.8, 0.8, 0.8),
bty = "n",
# lwd=0.8,
cex = 0.9,
pt.cex = 1,
ncol = 4)
par(xpd=TRUE)
GL.each(x = "LMAp1", y = "Aarea", subscript = " (b)")
GL.each(x = "LMAs1", y = "Aarea", subscript = " (c)")
GL.each(x = "LMA", y = "Rarea", subscript = " (d)",
y_text = expression(paste(italic(R)[area]," (", mu, "mol ", m^-2," ", s^-1, ")")))
GL.each(x = "LMAp1", y = "Rarea", subscript = " (e)")
GL.each(x = "LMAs1", y = "Rarea", subscript = " (f)")
GL.each(x = "LMA", y = "LL", subscript = " (g)",
y_text = expression(paste("LL (months)")),
x_text = expression(paste("LMA (g ",m^-2,")")))
GL.each(x = "LMAp1", y = "LL", subscript = " (h)",
x_text = expression(paste("LMAp (g ",m^-2,")")))
GL.each(x = "LMAs1", y = "LL", subscript = " (i)",
x_text = expression(paste("LMAs (g ",m^-2,")")))
par(mfrow = c(3, 3))
par(mar = c(0, 0, 0, 0))
par(oma = c(3, 3, 2, 2))
GL.each(x = "LMA", y = "Aarea", subscript = " (a)",
y_text = expression(paste(italic(A)[area]," (", mu, "mol ", m^-2," ", s^-1, ")")))
par(xpd=NA)
legend(10, 80, c("Evergreen", "Deciduous", "Unclassfied", "Rand"),
pch = c(21, 24, 21, 21),
pt.bg = c("green4", "dark orange", "white", "gray"),
col = c("black", "black", "black", "gray"),
pt.lwd = c(0.8, 0.8, 0.8),
bty = "n",
# lwd=0.8,
cex = 0.9,
pt.cex = 1,
ncol = 4)
par(xpd=TRUE)
GL.each(x = "LMAp4", y = "Aarea", subscript = " (b)")
GL.each(x = "LMAs4", y = "Aarea", subscript = " (c)")
GL.each(x = "LMA", y = "Rarea", subscript = " (d)",
y_text = expression(paste(italic(R)[area]," (", mu, "mol ", m^-2," ", s^-1, ")")))
GL.each(x = "LMAp4", y = "Rarea", subscript = " (e)")
GL.each(x = "LMAs4", y = "Rarea", subscript = " (f)")
GL.each(x = "LMA", y = "LL", subscript = " (g)",
y_text = expression(paste("LL (months)")),
x_text = expression(paste("LMA (g ",m^-2,")")))
GL.each(x = "LMAp4", y = "LL", subscript = " (h)",
x_text = expression(paste("LMAp (g ",m^-2,")")))
GL.each(x = "LMAs4", y = "LL", subscript = " (i)",
x_text = expression(paste("LMAs (g ",m^-2,")")))
setwd("~/Dropbox/MS/LES_MS/LMApsModel/data/")
# setwd("~/Dropbox/MS/LES_MS/LMApsModel/md/")
# render("GL_check.rmd", "bookdown::pdf_book")
# use null result 1
null_n <- 3
# GL data -------------------------------------------------------------------
load("GL_model1_obs_2017-06-19_.RData")
s1 <- fit.summary
GL <- data.obs
P_vec <- paste("p[", 1:nrow(GL), "]" ,sep = "")
GL <- GL %>%
mutate(DE = ifelse(GL$DE == "", "U", as.character(DE))) %>%
mutate(LMAp1 =  fit.summary[P_vec, "mean"] * LMA) %>%
mutate(LMAs1 = LMA - LMAp1)
load("GL_model1r4_obs_2017-06-19_.RData")
s4 <- fit.summary
GL <- GL %>%
mutate(LMAp4 =  fit.summary[P_vec, "mean"] * LMA) %>%
mutate(LMAs4 = LMA - LMAp4)
head(GL)
load("GL_model1_LMA_2017-06-19_.RData")
s1LMA <- fit.summary.list[[null_n]]
temp <- LMA.ra.data[,null_n]
GL <- GL %>%
mutate(LMA_ra = temp) %>%
mutate(LMAp1_ra =  s1LMA[P_vec, "mean"] * LMA_ra) %>%
mutate(LMAs1_ra = LMA_ra - LMAp1_ra)
head(GL)
load("GL_model1_All_2017-06-19_.RData")
# sp order
s1ALL <- fit.summary.list[[null_n]]
# sp order
temp <- LMA.ra2.data[[null_n]]
#arrange(LMA)
